{"version":3,"file":"loco.js","mappings":"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","sources":["webpack://Loco/webpack/universalModuleDefinition","webpack://Loco/./node_modules/loco-js-core/dist/loco-core.js","webpack://Loco/external umd {\"commonjs\":\"loco-js-model\",\"commonjs2\":\"loco-js-model\",\"amd\":\"loco-js-model\",\"root\":\"LocoModel\"}","webpack://Loco/webpack/bootstrap","webpack://Loco/webpack/runtime/define property getters","webpack://Loco/webpack/runtime/hasOwnProperty shorthand","webpack://Loco/webpack/runtime/make namespace object","webpack://Loco/./src/deps.js","webpack://Loco/./src/utils/object.coffee","webpack://Loco/./src/wire/openRequest.js","webpack://Loco/./src/line/idempotencyKeys.js","webpack://Loco/./src/getModelForRemoteName.coffee","webpack://Loco/./src/wire/processNotification.js","webpack://Loco/./src/wire.coffee","webpack://Loco/./src/line.js","webpack://Loco/./src/line/processSystemNotification.js","webpack://Loco/./src/loco.coffee","webpack://Loco/./src/index.js"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"loco-js-model\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"loco-js-model\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Loco\"] = factory(require(\"loco-js-model\"));\n\telse\n\t\troot[\"Loco\"] = factory(root[\"LocoModel\"]);\n})(self, (__WEBPACK_EXTERNAL_MODULE__904__) => {\nreturn ","!function(t,e){\"object\"==typeof exports&&\"object\"==typeof module?module.exports=e():\"function\"==typeof define&&define.amd?define([],e):\"object\"==typeof exports?exports.LocoCore=e():t.LocoCore=e()}(self,(()=>(()=>{\"use strict\";var t={d:(e,n)=>{for(var o in n)t.o(n,o)&&!t.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:n[o]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(t,\"__esModule\",{value:!0})}},e={};function n(t){return n=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&\"function\"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?\"symbol\":typeof t},n(t)}t.r(e),t.d(e,{helpers:()=>u,init:()=>i});var o=function(t){\"function\"==typeof t.constructor.initialize&&t.constructor.initialize(),\"function\"==typeof t.initialize&&t.initialize()},r=function(t,e,o){var r=void 0===o?t[e]:t[e][o];return\"function\"==typeof r?new r:\"object\"===n(r)?r:null};const i=function(t){var e=document.getElementsByTagName(\"body\")[0],n=e.getAttribute(\"data-namespace\"),i=e.getAttribute(\"data-controller\"),l=e.getAttribute(\"data-action\"),u=r(t,n),c=r(t,i);return null!==u&&(c=r(t,n,i),u.controller=c,o(u)),null!==c&&(c.namespaceController=u,function(t,e){o(t),\"function\"==typeof t.constructor[e]&&t.constructor[e](),\"function\"==typeof t[e]&&t[e]()}(c,l)),{namespaceController:u,controller:c,action:l}};function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}const u={get params(){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.location.href,e={},n=/https?:\\/\\/.+\\/\\w+\\/(\\d+)/.exec(t),o=null!==n?n[1]:null;null!==o&&(e.id=parseInt(o));var r=t.split(\"?\");if(1===r.length)return e;var i,u=function(t,e){var n=\"undefined\"!=typeof Symbol&&t[Symbol.iterator]||t[\"@@iterator\"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if(\"string\"==typeof t)return l(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return\"Object\"===n&&t.constructor&&(n=t.constructor.name),\"Map\"===n||\"Set\"===n?Array.from(t):\"Arguments\"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(t,e):void 0}}(t))||e&&t&&\"number\"==typeof t.length){n&&(t=n);var o=0,r=function(){};return{s:r,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:r}}throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}var i,u=!0,c=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return u=t.done,t},e:function(t){c=!0,i=t},f:function(){try{u||null==n.return||n.return()}finally{if(c)throw i}}}}(r[r.length-1].split(\"&\").map((function(t){return t.split(\"=\")})));try{for(u.s();!(i=u.n()).done;){var c=i.value,a=decodeURIComponent(c[0]),f=decodeURIComponent(c[1]);\"string\"==typeof f&&(f=f.replace(/\\+/g,\" \")),e[a]=f}}catch(t){u.e(t)}finally{u.f()}return e}()}};return e})()));\n//# sourceMappingURL=loco-core.js.map","module.exports = __WEBPACK_EXTERNAL_MODULE__904__;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import { init as initCore, helpers } from \"loco-js-core\";\n\nimport { Config, I18n, IdentityMap, Models, Validators } from \"loco-js-model\";\n\nclass Base {\n  setScope(name) {\n    Config.scope = name;\n  }\n\n  setResource(name) {\n    this.setScope(name);\n  }\n}\n\nconst Controllers = { Base };\n\nexport {\n  initCore,\n  helpers,\n  Config,\n  Controllers,\n  I18n,\n  IdentityMap,\n  Models,\n  Validators,\n};\n","class ObjectUtils\n  @toURIParams: (obj) ->\n    str = \"\"\n    for key, val of obj\n      if str isnt \"\"\n        str += \"&\"\n      str += (key + \"=\" + encodeURIComponent(val))\n    str\n\nexport default ObjectUtils","export default (httpMeth, url, opts) => {\n  const meta = document.querySelector(\"meta[name='csrf-token']\");\n  const req = new XMLHttpRequest();\n  req.withCredentials = opts.cookiesByCORS === true ? true : false;\n  req.open(httpMeth, url);\n  req.setRequestHeader(\"Accept\", \"application/json\");\n  if (meta) {\n    req.setRequestHeader(\"X-CSRF-Token\", meta.content);\n  }\n  if (opts.authorizationHeader != null) {\n    req.setRequestHeader(\"Authorization\", opts.authorizationHeader);\n  }\n  return req;\n};\n","const keys = [];\n\nexport default (key) => {\n  if (keys.includes(key)) return true;\n  keys.unshift(key);\n  if (keys.length > 100) keys.pop();\n  return false;\n};\n","import { Models } from './deps'\n\ngetModels = () ->\n  models = []\n  regExp = /^[A-Z]/\n  for func, _ of Models\n    continue if !regExp.exec(func) or func is \"Base\"\n    models.push func\n    for innerFunc, _ of Models[func]\n      models.push \"#{func}.#{innerFunc}\" if regExp.exec innerFunc\n  models\n\ngetModelForRemoteName = (remoteName) ->\n  for model in getModels()\n    parts = model.split \".\"\n    if parts.length is 1\n      return Models[parts[0]] if Models[parts[0]].getRemoteName() is remoteName\n    else if parts.length is 2\n      return Models[parts[0]][parts[1]] if Models[parts[0]][parts[1]].getRemoteName() is remoteName\n\nexport default getModelForRemoteName\n","import { IdentityMap } from \"../deps\";\nimport receivedAlready from \"../line/idempotencyKeys\";\nimport getModelForRemoteName from \"../getModelForRemoteName.coffee\";\n\nconst emitMessageToMembers = (\n  id,\n  name,\n  payload,\n  model,\n  identity,\n  obj = null\n) => {\n  if (obj === null) obj = new model({ id: id });\n  for (const connObj of IdentityMap.findConnected(identity, id)) {\n    connObj(name, payload);\n  }\n};\n\nconst emitMessageToCollection = (name, payload, identity) => {\n  for (const obj of IdentityMap.imap[identity][\"collection\"]) {\n    obj(`${identity} ${name}`, payload);\n  }\n};\n\nconst sendToNotificationCenter = (notificationCenter, type, payload, emit) => {\n  if (notificationCenter == null) return;\n  notificationCenter({ type, payload }, emit);\n};\n\nexport default (notification, opts = {}) => {\n  if (opts.log) console.log(notification);\n  const [className, id, name, payload] = notification;\n  if (receivedAlready(payload.loco.idempotency_key)) return false;\n  delete payload.loco;\n  const model = getModelForRemoteName(className);\n  if (model === undefined) {\n    sendToNotificationCenter(\n      opts.notificationCenter,\n      `${className} ${name}`,\n      payload,\n      opts.emit\n    );\n    return false;\n  }\n  const identity = model.getIdentity();\n  sendToNotificationCenter(\n    opts.notificationCenter,\n    `${identity} ${name}`,\n    payload,\n    opts.emit\n  );\n  if (IdentityMap.imap[identity] === undefined) return false;\n  if (IdentityMap.imap[identity][id] !== undefined)\n    emitMessageToMembers(id, name, payload, model, identity);\n  if (IdentityMap.imap[identity][\"collection\"] === undefined) return false;\n  if (IdentityMap.imap[identity][\"collection\"].length === 0) return false;\n  emitMessageToCollection(name, payload, identity);\n  return true;\n};\n","import { IdentityMap } from './deps'\nimport ObjectUtils from './utils/object.coffee'\nimport openRequest from './wire/openRequest'\nimport processNotification from \"./wire/processNotification\"\n\nclass Wire\n  constructor: (opts, notificationCenter, reqOpts) ->\n    this.pollingTime = opts.pollingTime ? 3000\n    this.log = if opts.log? and opts.log then true else false\n    this.ssl = opts.ssl\n    this.location = opts.location ? 'notification-center'\n    this.size = opts.size ? 100\n    this.protocolWithHost = opts.protocolWithHost\n    this.allowedDisconnectionTime = opts.allowedDisconnectionTime ? 10\n    this.disconnectedForTooLong = opts.disconnectedForTooLong\n    this.notificationCenter = notificationCenter\n    this.reqOpts = reqOpts\n    this.syncTime = null\n    this.token = null\n    this.pollingInterval = null\n    this.disconnectedSinceTime = null\n    this.uuid = null\n    this.line = null\n\n  setDisconnectedForTooLong: (fn) -> this.disconnectedForTooLong = fn\n\n  setLine: (line) -> this.line = line\n\n  setPollingTime: (val) ->\n    this.pollingTime = val\n    return if this.line?.connected\n    this.disconnect()\n    this.connect()\n\n  connect: ->\n    this.check();\n    this.pollingInterval = setInterval =>\n      if this.line?.connected\n        this.disconnect();\n        return\n      this.check();\n    , this.pollingTime\n\n  disconnect: ->\n    window.clearInterval(this.pollingInterval);\n\n  check: ->\n    request = openRequest('GET', this._getURL() + '?' + ObjectUtils.toURIParams(this._requestParams()), this.reqOpts)\n    request.onload = (e) =>\n      if e.target.status >= 200 and e.target.status < 400\n        data = JSON.parse e.target.response\n        this.disconnectedSinceTime = null\n        this.syncTime = data[1]\n        notifications = data[0]\n        return if notifications.length is 0\n        for notification in notifications\n          processNotification(notification, { log: this.log, notificationCenter: this.notificationCenter, emit: this.line.send })\n        this.check() if notifications.length is this.size\n      else if e.target.status >= 500\n        this._handleDisconnection()\n    request.onerror = =>\n      this._handleDisconnection()\n    request.send()\n\n  fetchSyncTime: (opts = {}) ->\n    request = openRequest('GET', \"#{this._getURL()}/sync-time\", this.reqOpts)\n    request.onerror = =>\n      this[opts.after]() if opts.after?\n    request.onload = (e) =>\n      if e.target.status >= 200 and e.target.status < 400\n        data = JSON.parse e.target.response\n        this.syncTime = data.sync_time\n        this[opts.after]() if opts.after?\n      else if e.target.status >= 500\n        this[opts.after]() if opts.after?\n    request.send()\n\n  _requestParams: ->\n    params = {synced_at: this.syncTime}\n    if this.token? then params.token = this.token\n    if this.uuid? then params.uuid = this.uuid\n    params\n\n  _getURL: ->\n    [protocol, _, host] = window.location.href.split '/'\n    if this.protocolWithHost?\n      [protocol, host] = this.protocolWithHost.split '//'\n    if this.ssl?\n      protocol = if this.ssl then 'https:' else \"http:\"\n    \"#{protocol}//#{host}/#{this.location}\"\n\n  _handleDisconnection: ->\n    if not this.disconnectedSinceTime?\n      this.disconnectedSinceTime = new Date()\n    diffInSec = (new Date() - this.disconnectedSinceTime) / 1000\n    if diffInSec > this.allowedDisconnectionTime and this.disconnectedForTooLong?\n      this.disconnectedForTooLong(this.disconnectedSinceTime)\n\nexport default Wire","import processNotification from \"./wire/processNotification\";\nimport processSystemNotification from \"./line/processSystemNotification\";\n\nclass Line {\n  constructor(cable, notificationCenter, wire) {\n    this.cable = cable;\n    this.notificationCenter = notificationCenter;\n    this.wire = wire;\n    this.connected = false;\n    this.subscription = null;\n  }\n\n  connect() {\n    this.subscription = this.cable.subscriptions.create(\n      {\n        channel: \"Loco::NotificationCenterChannel\",\n      },\n      {\n        connected: () => {\n          console.log(\"WS connected\");\n          this.connected = true;\n          this.notificationCenter({ loco: \"connected\" });\n          this.pong();\n        },\n        disconnected: () => {\n          console.log(\"WS disconnected\");\n          this.connected = false;\n          if (this.wire !== null) {\n            this.wire.uuid = null;\n            this.wire.fetchSyncTime({ after: \"connect\" });\n          }\n          this.notificationCenter({ loco: \"disconnected\" });\n        },\n        rejected: () => {\n          console.log(\"WS rejected\");\n          this.notificationCenter({ loco: \"rejected\" });\n        },\n        received: (data) => {\n          if (data.loco != null) {\n            const res = processSystemNotification(data.loco, {\n              line: this,\n              wire: this.wire,\n              processNotification,\n              notificationCenter: this.notificationCenter,\n            });\n            if (res !== true) return;\n            delete data.loco;\n          }\n          if (Object.keys(data).length === 0) return;\n          this.notificationCenter(data);\n        },\n      }\n    );\n  }\n\n  send(payload) {\n    this.subscription.send(payload);\n  }\n\n  pong() {\n    setTimeout(() => this.send({ loco: { pong: true } }), 3000);\n  }\n}\n\nexport default Line;\n","import receivedAlready from \"./idempotencyKeys\";\n\nexport default (\n  data,\n  { line, wire, processNotification, notificationCenter }\n) => {\n  if (data.ping === true) {\n    line.pong();\n  }\n  if (wire == null) return;\n  if (typeof data.sync_time === \"string\") {\n    wire.syncTime = data.sync_time;\n  }\n  if (typeof data.uuid === \"string\") {\n    console.log(`uuid: ${data.uuid}`);\n    wire.uuid = data.uuid;\n  }\n  if (\n    typeof data.notification === \"object\" &&\n    data.notification.constructor.name === \"Array\"\n  ) {\n    processNotification(data.notification, {\n      log: wire.log,\n      notificationCenter,\n      emit: this.line.send\n    });\n  }\n  if (typeof data.idempotency_key === \"string\") {\n    if (receivedAlready(data.idempotency_key)) return false;\n  }\n  return true;\n};\n","import { initCore, Controllers, IdentityMap } from './deps'\nimport Wire from './wire.coffee'\nimport Line from './line'\n\nclass Loco\n  constructor: (models) ->\n    this.env = {namespaceController: null, controller: null, action: null, models: models}\n    this.wire = null\n    this.line = null\n\n  getEnv: -> this.env\n\n  getLine: -> this.line?.subscription\n\n  getWire: -> this.wire\n\n  setAuthorizationHeader: (val) ->\n    for key, model of this.env.models\n      model.authorizationHeader = val\n\n  setDisconnectedForTooLong: (fn) ->\n    this.wire.setDisconnectedForTooLong(fn);\n\n  init: (opts) ->\n    notificationsParams = opts.notifications ? {}\n    notificationsParams.protocolWithHost = opts.protocolWithHost\n    if notificationsParams.enable isnt false\n      wireOpts = { cookiesByCORS: opts.cookiesByCORS, authorizationHeader: opts.authorizationHeader }\n      this.wire = new Wire(notificationsParams, opts.notificationCenter, wireOpts)\n      this.wire.fetchSyncTime({ after: 'connect' })\n    if opts.cable?\n      this.line = new Line(opts.cable, opts.notificationCenter, this.wire)\n      this.line.connect()\n    if this.wire?\n      this.wire.setLine(this.line);\n    this._ready =>\n      IdentityMap.clear()\n      env = initCore(Controllers);\n      this.env.namespaceController = env.namespaceController\n      this.env.controller = env.controller\n      this.env.action = env.action\n      opts.postInit() if opts.postInit?\n\n  emit: (payload) -> this.line.send(payload)\n\n  _ready: (fn) ->\n    cond = if document.attachEvent then document.readyState is \"complete\" else document.readyState isnt \"loading\"\n    if cond\n      fn()\n    else\n      document.addEventListener 'DOMContentLoaded', fn\n\nexport default Loco","import Loco from \"./loco.coffee\";\nimport {\n  helpers,\n  Config,\n  Controllers,\n  I18n,\n  IdentityMap,\n  Models,\n  Validators,\n} from \"./deps\";\n\nconst processModels = (opts) => {\n  const models = opts.models || {};\n  for (const i of Object.keys(models)) {\n    Models[i] = models[i];\n    if (opts.protocolWithHost != null) {\n      Models[i].protocolWithHost = opts.protocolWithHost;\n    }\n    if (opts.authorizationHeader != null) {\n      Models[i].authorizationHeader = opts.authorizationHeader;\n    }\n    if (opts.cookiesByCORS != null) {\n      Models[i].cookiesByCORS = opts.cookiesByCORS;\n    }\n  }\n  return models;\n};\n\nconst getLocale = () => Config.locale;\nconst setLocale = (locale) => (Config.locale = locale);\n\nconst init = (opts) => {\n  Config.cookiesByCORS = opts.cookiesByCORS || false;\n  Config.locale = opts.locale || \"en\";\n  for (const i of Object.keys(opts.controllers || {})) {\n    Controllers[i] = opts.controllers[i];\n  }\n  const models = processModels(opts);\n  const loco = new Loco(models);\n  loco.init(opts);\n  return loco;\n};\n\nconst createConnector = (loco) => ({ getLocale, loco, I18n });\n\nconst subscribe = IdentityMap.subscribe;\n\nexport {\n  getLocale,\n  setLocale,\n  createConnector,\n  helpers,\n  init,\n  subscribe,\n  Controllers,\n  I18n,\n  Models,\n  Validators,\n};\n"],"names":["root","factory","exports","module","require","define","amd","self","__WEBPACK_EXTERNAL_MODULE__904__","t","d","e","n","o","Object","defineProperty","enumerable","get","prototype","hasOwnProperty","call","r","Symbol","toStringTag","value","iterator","constructor","helpers","u","init","i","initialize","document","getElementsByTagName","getAttribute","l","c","controller","namespaceController","action","length","Array","params","arguments","window","location","href","exec","id","parseInt","split","isArray","toString","slice","name","from","test","s","done","f","TypeError","next","return","map","a","decodeURIComponent","replace","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","definition","key","obj","prop","Controllers","Base","_classCallCheck","Config","scope","this","setScope","toURIParams","str","encodeURIComponent","val","httpMeth","url","opts","meta","querySelector","req","XMLHttpRequest","withCredentials","cookiesByCORS","open","setRequestHeader","content","authorizationHeader","keys","includes","unshift","pop","getModels","models","regExp","func","push","innerFunc","sendToNotificationCenter","notificationCenter","type","payload","emit","notification","log","console","_notification","className","receivedAlready","loco","idempotency_key","model","remoteName","parts","Models","getRemoteName","getModelForRemoteName","concat","identity","getIdentity","IdentityMap","imap","_step","_iterator","_createForOfIteratorHelper","findConnected","connObj","err","emitMessageToMembers","_step2","_iterator2","emitMessageToCollection","Wire","reqOpts","pollingTime","ssl","size","protocolWithHost","allowedDisconnectionTime","disconnectedForTooLong","syncTime","token","pollingInterval","disconnectedSinceTime","uuid","line","setDisconnectedForTooLong","fn","setLine","setPollingTime","connected","disconnect","connect","check","setInterval","clearInterval","request","openRequest","_getURL","_requestParams","onload","target","status","data","JSON","parse","response","notifications","processNotification","send","_handleDisconnection","onerror","fetchSyncTime","after","sync_time","synced_at","protocol","host","Date","Line","cable","wire","subscription","_this","subscriptions","create","channel","pong","disconnected","rejected","received","_ref","ping","_typeof","processSystemNotification","_this2","setTimeout","env","getEnv","getLine","getWire","setAuthorizationHeader","notificationsParams","enable","wireOpts","_ready","clear","postInit","attachEvent","readyState","addEventListener","getLocale","locale","setLocale","_i2","_Object$keys2","controllers","_i","_Object$keys","processModels","Loco","createConnector","I18n","subscribe"],"sourceRoot":""}