{"version":3,"file":"loco.js","mappings":"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","sources":["webpack://Loco/webpack/universalModuleDefinition","webpack://Loco/./node_modules/loco-js-core/dist/loco-core.js","webpack://Loco/external umd {\"commonjs\":\"loco-js-model\",\"commonjs2\":\"loco-js-model\",\"amd\":\"loco-js-model\",\"root\":\"LocoModel\"}","webpack://Loco/webpack/bootstrap","webpack://Loco/webpack/runtime/define property getters","webpack://Loco/webpack/runtime/hasOwnProperty shorthand","webpack://Loco/webpack/runtime/make namespace object","webpack://Loco/./src/deps.js","webpack://Loco/./src/utils/object.coffee","webpack://Loco/./src/wire/openRequest.js","webpack://Loco/./src/line/idempotencyKeys.js","webpack://Loco/./src/getModelForRemoteName.coffee","webpack://Loco/./src/wire/processNotification.js","webpack://Loco/./src/wire.coffee","webpack://Loco/./src/line.js","webpack://Loco/./src/line/processSystemNotification.js","webpack://Loco/./src/loco.coffee","webpack://Loco/./src/index.js"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"loco-js-model\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"loco-js-model\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Loco\"] = factory(require(\"loco-js-model\"));\n\telse\n\t\troot[\"Loco\"] = factory(root[\"LocoModel\"]);\n})(self, (__WEBPACK_EXTERNAL_MODULE__854__) => {\nreturn ","!function(t,n){\"object\"==typeof exports&&\"object\"==typeof module?module.exports=n():\"function\"==typeof define&&define.amd?define([],n):\"object\"==typeof exports?exports.LocoCore=n():t.LocoCore=n()}(window,(function(){return function(t){var n={};function e(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,e),o.l=!0,o.exports}return e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:r})},e.r=function(t){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(t,\"__esModule\",{value:!0})},e.t=function(t,n){if(1&n&&(t=e(t)),8&n)return t;if(4&n&&\"object\"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(e.r(r),Object.defineProperty(r,\"default\",{enumerable:!0,value:t}),2&n&&\"string\"!=typeof t)for(var o in t)e.d(r,o,function(n){return t[n]}.bind(null,o));return r},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,\"a\",n),n},e.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},e.p=\"\",e(e.s=0)}([function(t,n,e){\"use strict\";function r(t){return(r=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&\"function\"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?\"symbol\":typeof t})(t)}e.r(n),e.d(n,\"init\",(function(){return u})),e.d(n,\"helpers\",(function(){return l}));var o=function(t){\"function\"==typeof t.constructor.initialize&&t.constructor.initialize(),\"function\"==typeof t.initialize&&t.initialize()},i=function(t,n,e){var o=void 0===e?t[n]:t[n][e];return\"function\"==typeof o?new o:\"object\"===r(o)?o:null},u=function(t){var n=document.getElementsByTagName(\"body\")[0],e=n.getAttribute(\"data-namespace\"),r=n.getAttribute(\"data-controller\"),u=n.getAttribute(\"data-action\"),c=i(t,e),f=i(t,r);return null!==c&&(f=i(t,e,r),c.controller=f,o(c)),null!==f&&(f.namespaceController=c,function(t,n){o(t),\"function\"==typeof t.constructor[n]&&t.constructor[n](),\"function\"==typeof t[n]&&t[n]()}(f,u)),{namespaceController:c,controller:f,action:u}};function c(t,n){var e;if(\"undefined\"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if(\"string\"==typeof t)return f(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);\"Object\"===e&&t.constructor&&(e=t.constructor.name);if(\"Map\"===e||\"Set\"===e)return Array.from(t);if(\"Arguments\"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return f(t,n)}(t))||n&&t&&\"number\"==typeof t.length){e&&(t=e);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}var i,u=!0,c=!1;return{s:function(){e=t[Symbol.iterator]()},n:function(){var t=e.next();return u=t.done,t},e:function(t){c=!0,i=t},f:function(){try{u||null==e.return||e.return()}finally{if(c)throw i}}}}function f(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}var l={get params(){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.location.href,n={},e=/https?:\\/\\/.+\\/\\w+\\/(\\d+)/.exec(t),r=null!==e?e[1]:null;null!==r&&(n.id=parseInt(r));var o=t.split(\"?\");if(1===o.length)return n;var i,u=o[o.length-1],f=u.split(\"&\").map((function(t){return t.split(\"=\")})),l=c(f);try{for(l.s();!(i=l.n()).done;){var a=i.value,p=decodeURIComponent(a[0]),y=decodeURIComponent(a[1]);\"string\"==typeof y&&(y=y.replace(/\\+/g,\" \")),n[p]=y}}catch(t){l.e(t)}finally{l.f()}return n}()}}}])}));","module.exports = __WEBPACK_EXTERNAL_MODULE__854__;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import { init as initCore, helpers } from \"loco-js-core\";\n\nimport { Config, I18n, IdentityMap, Models, Validators } from \"loco-js-model\";\n\nclass Base {\n  setScope(name) {\n    Config.scope = name;\n  }\n\n  setResource(name) {\n    this.setScope(name);\n  }\n}\n\nconst Controllers = { Base };\n\nexport {\n  initCore,\n  helpers,\n  Config,\n  Controllers,\n  I18n,\n  IdentityMap,\n  Models,\n  Validators,\n};\n","class ObjectUtils\n  @toURIParams: (obj) ->\n    str = \"\"\n    for key, val of obj\n      if str isnt \"\"\n        str += \"&\"\n      str += (key + \"=\" + encodeURIComponent(val))\n    str\n\nexport default ObjectUtils","export default (httpMeth, url, opts) => {\n  const meta = document.querySelector(\"meta[name='csrf-token']\");\n  const req = new XMLHttpRequest();\n  req.withCredentials = opts.cookiesByCORS === true ? true : false;\n  req.open(httpMeth, url);\n  req.setRequestHeader(\"Accept\", \"application/json\");\n  if (meta) {\n    req.setRequestHeader(\"X-CSRF-Token\", meta.content);\n  }\n  if (opts.authorizationHeader != null) {\n    req.setRequestHeader(\"Authorization\", opts.authorizationHeader);\n  }\n  return req;\n};\n","const keys = [];\n\nexport default (key) => {\n  if (keys.includes(key)) return true;\n  keys.unshift(key);\n  if (keys.length > 100) keys.pop();\n  return false;\n};\n","import { Models } from './deps'\n\ngetModels = () ->\n  models = []\n  regExp = /^[A-Z]/\n  for func, _ of Models\n    continue if !regExp.exec(func) or func is \"Base\"\n    models.push func\n    for innerFunc, _ of Models[func]\n      models.push \"#{func}.#{innerFunc}\" if regExp.exec innerFunc\n  models\n\ngetModelForRemoteName = (remoteName) ->\n  for model in getModels()\n    parts = model.split \".\"\n    if parts.length is 1\n      return Models[parts[0]] if Models[parts[0]].getRemoteName() is remoteName\n    else if parts.length is 2\n      return Models[parts[0]][parts[1]] if Models[parts[0]][parts[1]].getRemoteName() is remoteName\n\nexport default getModelForRemoteName\n","import { IdentityMap } from \"../deps\";\nimport receivedAlready from \"../line/idempotencyKeys\";\nimport getModelForRemoteName from \"../getModelForRemoteName.coffee\";\n\nconst emitMessageToMembers = (\n  id,\n  name,\n  payload,\n  model,\n  identity,\n  obj = null\n) => {\n  if (obj === null) obj = new model({ id: id });\n  for (const connObj of IdentityMap.findConnected(identity, id)) {\n    connObj(name, payload);\n  }\n};\n\nconst emitMessageToCollection = (name, payload, identity) => {\n  for (const obj of IdentityMap.imap[identity][\"collection\"]) {\n    obj(`${identity} ${name}`, payload);\n  }\n};\n\nexport default (notification, opts = {}) => {\n  if (opts.log) console.log(notification);\n  const [className, id, name, payload] = notification;\n  if (receivedAlready(payload.loco.idempotency_key)) return false;\n  const model = getModelForRemoteName(className);\n  const identity = model.getIdentity();\n  if (opts.notificationCenter != null) {\n    opts.notificationCenter({\n      type: `${identity} ${name}`,\n      payload: payload,\n    });\n  }\n  if (IdentityMap.imap[identity] === undefined) return false;\n  if (IdentityMap.imap[identity][id] !== undefined)\n    emitMessageToMembers(id, name, payload, model, identity);\n  if (IdentityMap.imap[identity][\"collection\"] === undefined) return false;\n  if (IdentityMap.imap[identity][\"collection\"].length === 0) return false;\n  emitMessageToCollection(name, payload, identity);\n  return true;\n};\n","import { IdentityMap } from './deps'\nimport ObjectUtils from './utils/object.coffee'\nimport openRequest from './wire/openRequest'\nimport processNotification from \"./wire/processNotification\"\n\nclass Wire\n  constructor: (opts, notificationCenter, reqOpts) ->\n    this.pollingTime = opts.pollingTime ? 3000\n    this.log = if opts.log? and opts.log then true else false\n    this.ssl = opts.ssl\n    this.location = opts.location ? 'notification-center'\n    this.size = opts.size ? 100\n    this.protocolWithHost = opts.protocolWithHost\n    this.allowedDisconnectionTime = opts.allowedDisconnectionTime ? 10\n    this.disconnectedForTooLong = opts.disconnectedForTooLong\n    this.notificationCenter = notificationCenter\n    this.reqOpts = reqOpts\n    this.syncTime = null\n    this.token = null\n    this.pollingInterval = null\n    this.disconnectedSinceTime = null\n    this.uuid = null\n    this.line = null\n\n  setDisconnectedForTooLong: (fn) -> this.disconnectedForTooLong = fn\n\n  setLine: (line) -> this.line = line\n\n  setPollingTime: (val) ->\n    this.pollingTime = val\n    return if this.line?.connected\n    this.disconnect()\n    this.connect()\n\n  connect: ->\n    this.check();\n    this.pollingInterval = setInterval =>\n      if this.line?.connected\n        this.disconnect();\n        return\n      this.check();\n    , this.pollingTime\n\n  disconnect: ->\n    window.clearInterval(this.pollingInterval);\n\n  check: ->\n    return if Object.keys(IdentityMap.imap).length is 0 and not this.token? and this.syncTime?\n    request = openRequest('GET', this._getURL() + '?' + ObjectUtils.toURIParams(this._requestParams()), this.reqOpts)\n    request.onload = (e) =>\n      if e.target.status >= 200 and e.target.status < 400\n        data = JSON.parse e.target.response\n        this.disconnectedSinceTime = null\n        this.syncTime = data[1]\n        notifications = data[0]\n        return if notifications.length is 0\n        processNotification(notification, { log: this.log, notificationCenter: this.notificationCenter }) for notification in notifications\n        this.check() if notifications.length is this.size\n      else if e.target.status >= 500\n        this._handleDisconnection()\n    request.onerror = =>\n      this._handleDisconnection()\n    request.send()\n\n  fetchSyncTime: (opts = {}) ->\n    request = openRequest('GET', \"#{this._getURL()}/sync-time\", this.reqOpts)\n    request.onerror = =>\n      this[opts.after]() if opts.after?\n    request.onload = (e) =>\n      if e.target.status >= 200 and e.target.status < 400\n        data = JSON.parse e.target.response\n        this.syncTime = data.sync_time\n        this[opts.after]() if opts.after?\n      else if e.target.status >= 500\n        this[opts.after]() if opts.after?\n    request.send()\n\n  _requestParams: ->\n    params = {synced_at: this.syncTime}\n    if this.token? then params.token = this.token\n    if this.uuid? then params.uuid = this.uuid\n    params\n\n  _getURL: ->\n    [protocol, _, host] = window.location.href.split '/'\n    if this.protocolWithHost?\n      [protocol, host] = this.protocolWithHost.split '//'\n    if this.ssl?\n      protocol = if this.ssl then 'https:' else \"http:\"\n    \"#{protocol}//#{host}/#{this.location}\"\n\n  _handleDisconnection: ->\n    if not this.disconnectedSinceTime?\n      this.disconnectedSinceTime = new Date()\n    diffInSec = (new Date() - this.disconnectedSinceTime) / 1000\n    if diffInSec > this.allowedDisconnectionTime and this.disconnectedForTooLong?\n      this.disconnectedForTooLong(this.disconnectedSinceTime)\n\nexport default Wire","import processNotification from \"./wire/processNotification\";\nimport processSystemNotification from \"./line/processSystemNotification\";\n\nclass Line {\n  constructor(cable, notificationCenter, wire) {\n    this.cable = cable;\n    this.notificationCenter = notificationCenter;\n    this.wire = wire;\n    this.connected = false;\n    this.subscription = null;\n  }\n\n  connect() {\n    this.subscription = this.cable.subscriptions.create(\n      {\n        channel: \"Loco::NotificationCenterChannel\",\n      },\n      {\n        connected: () => {\n          console.log(\"WS connected\");\n          this.connected = true;\n          this.notificationCenter({ loco: \"connected\" });\n          this.pong();\n        },\n        disconnected: () => {\n          console.log(\"WS disconnected\");\n          this.connected = false;\n          if (this.wire !== null) {\n            this.wire.uuid = null;\n            this.wire.fetchSyncTime({ after: \"connect\" });\n          }\n          this.notificationCenter({ loco: \"disconnected\" });\n        },\n        rejected: () => {\n          console.log(\"WS rejected\");\n          this.notificationCenter({ loco: \"rejected\" });\n        },\n        received: (data) => {\n          if (data.loco != null) {\n            const res = processSystemNotification(data.loco, {\n              line: this,\n              wire: this.wire,\n              processNotification,\n              notificationCenter: this.notificationCenter,\n            });\n            if (res !== true) return;\n            delete data.loco;\n          }\n          if (Object.keys(data).length === 0) return;\n          this.notificationCenter(data);\n        },\n      }\n    );\n  }\n\n  send(payload) {\n    this.subscription.send(payload);\n  }\n\n  pong() {\n    setTimeout(() => this.send({ loco: { pong: true } }), 3000);\n  }\n}\n\nexport default Line;\n","import receivedAlready from \"./idempotencyKeys\";\n\nexport default (\n  data,\n  { line, wire, processNotification, notificationCenter }\n) => {\n  if (data.ping === true) {\n    line.pong();\n  }\n  if (wire == null) return;\n  if (typeof data.sync_time === \"string\") {\n    wire.syncTime = data.sync_time;\n  }\n  if (typeof data.uuid === \"string\") {\n    console.log(`uuid: ${data.uuid}`);\n    wire.uuid = data.uuid;\n  }\n  if (\n    typeof data.notification === \"object\" &&\n    data.notification.constructor.name === \"Array\"\n  ) {\n    processNotification(data.notification, {\n      log: wire.log,\n      notificationCenter,\n    });\n  }\n  if (typeof data.idempotency_key === \"string\") {\n    if (receivedAlready(data.idempotency_key)) return false;\n  }\n  return true;\n};\n","import { initCore, Controllers, IdentityMap } from './deps'\nimport Wire from './wire.coffee'\nimport Line from './line'\n\nclass Loco\n  constructor: (models) ->\n    this.env = {namespaceController: null, controller: null, action: null, models: models}\n    this.wire = null\n    this.line = null\n\n  getEnv: -> this.env\n\n  getLine: -> this.line?.subscription\n\n  getWire: -> this.wire\n\n  setAuthorizationHeader: (val) ->\n    for key, model of this.env.models\n      model.authorizationHeader = val\n\n  setDisconnectedForTooLong: (fn) ->\n    this.wire.setDisconnectedForTooLong(fn);\n\n  init: (opts) ->\n    notificationsParams = opts.notifications ? {}\n    notificationsParams.protocolWithHost = opts.protocolWithHost\n    if notificationsParams?.enable isnt false\n      wireOpts = { cookiesByCORS: opts.cookiesByCORS, authorizationHeader: opts.authorizationHeader }\n      this.wire = new Wire(notificationsParams, opts.notificationCenter, wireOpts)\n      this.wire.fetchSyncTime({ after: 'connect' })\n    if opts.cable?\n      this.line = new Line(opts.cable, opts.notificationCenter, this.wire)\n      this.line.connect()\n    if this.wire?\n      this.wire.setLine(this.line);\n    this._ready =>\n      IdentityMap.clear()\n      env = initCore(Controllers);\n      this.env.namespaceController = env.namespaceController\n      this.env.controller = env.controller\n      this.env.action = env.action\n      opts.postInit() if opts.postInit?\n\n  emit: (payload) -> this.line.send(payload)\n\n  _ready: (fn) ->\n    cond = if document.attachEvent then document.readyState is \"complete\" else document.readyState isnt \"loading\"\n    if cond\n      fn()\n    else\n      document.addEventListener 'DOMContentLoaded', fn\n\nexport default Loco","import Loco from \"./loco.coffee\";\nimport {\n  helpers,\n  Config,\n  Controllers,\n  I18n,\n  IdentityMap,\n  Models,\n  Validators,\n} from \"./deps\";\n\nconst processModels = (opts) => {\n  const models = opts.models || {};\n  for (const i of Object.keys(models)) {\n    Models[i] = models[i];\n    if (opts.protocolWithHost != null) {\n      Models[i].protocolWithHost = opts.protocolWithHost;\n    }\n    if (opts.authorizationHeader != null) {\n      Models[i].authorizationHeader = opts.authorizationHeader;\n    }\n    if (opts.cookiesByCORS != null) {\n      Models[i].cookiesByCORS = opts.cookiesByCORS;\n    }\n  }\n  return models;\n};\n\nconst getLocale = () => Config.locale;\nconst setLocale = (locale) => (Config.locale = locale);\n\nconst init = (opts) => {\n  Config.cookiesByCORS = opts.cookiesByCORS || false;\n  Config.locale = opts.locale || \"en\";\n  for (const i of Object.keys(opts.controllers || {})) {\n    Controllers[i] = opts.controllers[i];\n  }\n  const models = processModels(opts);\n  const loco = new Loco(models);\n  loco.init(opts);\n  return loco;\n};\n\nconst createConnector = (loco) => ({ getLocale, loco, I18n });\n\nconst subscribe = IdentityMap.subscribe;\n\nexport {\n  getLocale,\n  setLocale,\n  createConnector,\n  helpers,\n  init,\n  subscribe,\n  Controllers,\n  I18n,\n  Models,\n  Validators,\n};\n"],"names":["root","factory","exports","module","require","define","amd","self","__WEBPACK_EXTERNAL_MODULE__854__","window","t","n","e","r","o","i","l","call","m","c","d","Object","defineProperty","enumerable","get","Symbol","toStringTag","value","__esModule","create","bind","default","prototype","hasOwnProperty","p","s","iterator","constructor","u","initialize","document","getElementsByTagName","getAttribute","f","controller","namespaceController","action","Array","isArray","toString","slice","name","from","test","length","done","TypeError","next","return","params","arguments","location","href","exec","id","parseInt","split","map","a","decodeURIComponent","y","replace","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","definition","key","obj","prop","Controllers","Base","_classCallCheck","Config","this","setScope","toURIParams","str","encodeURIComponent","val","httpMeth","url","opts","meta","querySelector","req","XMLHttpRequest","withCredentials","cookiesByCORS","open","setRequestHeader","content","authorizationHeader","keys","includes","unshift","pop","getModels","models","regExp","func","push","innerFunc","notification","log","console","_notification","className","payload","receivedAlready","loco","idempotency_key","model","remoteName","parts","Models","getRemoteName","getModelForRemoteName","identity","getIdentity","notificationCenter","type","concat","IdentityMap","_step","_iterator","_createForOfIteratorHelper","connObj","err","emitMessageToMembers","_step2","_iterator2","emitMessageToCollection","Wire","reqOpts","pollingTime","ssl","size","protocolWithHost","allowedDisconnectionTime","disconnectedForTooLong","syncTime","token","pollingInterval","disconnectedSinceTime","uuid","line","setDisconnectedForTooLong","fn","setLine","setPollingTime","connected","disconnect","connect","check","setInterval","clearInterval","request","openRequest","_getURL","_requestParams","onload","target","status","data","JSON","parse","response","notifications","processNotification","_handleDisconnection","onerror","send","fetchSyncTime","after","sync_time","synced_at","protocol","host","Date","Line","cable","wire","subscription","_this","subscriptions","channel","pong","disconnected","rejected","received","res","_ref","ping","_typeof","processSystemNotification","_this2","setTimeout","env","getEnv","getLine","getWire","setAuthorizationHeader","init","notificationsParams","enable","wireOpts","_ready","postInit","emit","attachEvent","readyState","addEventListener","getLocale","setLocale","locale","_i2","_Object$keys2","controllers","_i","_Object$keys","processModels","Loco","createConnector","I18n","subscribe"],"sourceRoot":""}