!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("loco-js-model")):"function"==typeof define&&define.amd?define(["loco-js-model"],t):"object"==typeof exports?exports.App=t(require("loco-js-model")):e.App=t(e.LocoModel)}(window,(function(e){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=22)}([function(e,t,n){"use strict";n.r(t),n.d(t,"Deps",(function(){return i}));var r=n(1);n.d(t,"Base",(function(){return r.Base})),n.d(t,"Config",(function(){return r.Config})),n.d(t,"I18n",(function(){return r.I18n})),n.d(t,"IdentityMap",(function(){return r.IdentityMap})),n.d(t,"Models",(function(){return r.Models})),n.d(t,"Validators",(function(){return r.Validators}));var i={cable:null,NotificationCenter:null}},function(t,n){t.exports=e},function(e,t,n){"use strict";n.r(t);t.default={loco:null,namespaceController:null,controller:null,action:null}},function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(15),o=n.n(i);r.I18n.en=o.a,t.default=r.I18n},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();r=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return i(e,null,[{key:"map",value:function(e,t){var n,r,i,o;for(i=[],n=0,r=e.length;n<r;n++)o=e[n],i.push(t(o));return i}},{key:"uniq",value:function(e){var t,n,r,i;for(r=[],t=0,n=e.length;t<n;t++)i=e[t],-1===r.indexOf(i)&&r.push(i);return r}}]),e}(),t.default=r},function(e,t,n){"use strict";n.r(t);t.default={Loco:{}}},function(e,t,n){"use strict";n.r(t);var r=n(13),i={Base:n.n(r).a};t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=a(n(5)),l=a(n(2)),u=n(0);function a(e){return e&&e.__esModule?e:{default:e}}r=function(){function e(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.connected=!1}return i(e,[{key:"connect",value:function(){var e=this;return o.default.Loco.NotificationCenter=u.Deps.cable.subscriptions.create({channel:"Loco::NotificationCenterChannel"},{connected:function(){var t;return console.log("ws connected"),e.connected=!0,null!=(t=l.default.loco.getWire())&&t.setDelayedDisconnection(),e._sendNotification({loco:"connected"})},disconnected:function(){var t;return console.log("ws disconnected"),e.connected=!1,null!=(t=l.default.loco.getWire())&&(t.setUuid(null),t.fetchSyncTime({after:"connect"})),e._sendNotification({loco:"disconnected"})},rejected:function(){return console.log("ws rejected"),e._sendNotification({loco:"rejected"})},received:function(t){if(null!=t.loco&&(e._processSystemNotification(t.loco),delete t.loco),0!==Object.keys(t).length)return e._sendNotification(t)}})}},{key:"isWireAllowed",value:function(){return!this.connected}},{key:"send",value:function(e){return o.default.Loco.NotificationCenter.send(e)}},{key:"_processSystemNotification",value:function(e){var t;if(null!=e.connection_check&&this.send({loco:{connection_check:!0}}),null!=(t=l.default.loco.getWire()))return null!=e.sync_time&&t.setSyncTime(e.sync_time),null!=e.uuid&&(console.log("uuid: "+e.uuid),t.setUuid(e.uuid)),null!=e.notification&&t.processNotification(e.notification),null!=e.xhr_notifications&&t.check(),e.start_ajax_polling?(console.log("wire connected"),this.connected=null,t.setUuid(null),t.fetchSyncTime({after:"connect"})):void 0}},{key:"_sendNotification",value:function(e){return null!=u.Deps.NotificationCenter.receivedSignal?u.Deps.NotificationCenter.receivedSignal(e):(new u.Deps.NotificationCenter).receivedSignal(e)}}]),e}(),t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var l,u=e[Symbol.iterator]();!(r=(l=u.next()).done)&&(n.push(l.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{!r&&u.return&&u.return()}finally{if(i)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=s(n(2)),u=n(0),a=s(n(10));function s(e){return e&&e.__esModule?e:{default:e}}r=function(){function e(){var t,n,r,i,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.syncTime=null,this.token=null,this.pollingInterval=null,this.pollingTime=null!=(t=o.pollingTime)?t:3e3,this.log=!(null==o.log||!o.log),this.ssl=o.ssl,this.location=null!=(n=o.location)?n:"notification-center",this.size=null!=(r=o.size)?r:100,this.protocolWithHost=o.protocolWithHost,this.allowedDisconnectionTime=null!=(i=o.allowedDisconnectionTime)?i:10,this.disconnectedSinceTime=null,this.uuid=null,this.delayedDisconnection=!1}return o(e,[{key:"setToken",value:function(e){return this.token=e}},{key:"getSyncTime",value:function(){return this.syncTime}},{key:"setSyncTime",value:function(e){return this.syncTime=e}},{key:"resetSyncTime",value:function(){return this.syncTime=null}},{key:"getPollingTime",value:function(){return this.pollingTime}},{key:"setPollingTime",value:function(e){return this.pollingTime=e,this.disconnect(),this.connect()}},{key:"getPollingInterval",value:function(){return this.pollingInterval}},{key:"getSSL",value:function(){return this.ssl}},{key:"setSSL",value:function(e){return this.ssl=e}},{key:"getLocation",value:function(){return this.location}},{key:"setLocation",value:function(e){return this.location=e}},{key:"getSize",value:function(){return this.size}},{key:"setSize",value:function(e){return this.size=e}},{key:"getAllowedDisconnectionTime",value:function(){return this.allowedDisconnectionTime}},{key:"setAllowedDisconnectionTime",value:function(e){return this.allowedDisconnectionTime=e}},{key:"getUuid",value:function(){return this.uuid}},{key:"setUuid",value:function(e){return this.uuid=e}},{key:"setDelayedDisconnection",value:function(){return this.delayedDisconnection=!0}},{key:"connect",value:function(){var e,t=this;if(null==(e=l.default.loco.getLine())||e.isWireAllowed())return this.pollingInterval=setInterval((function(){if(t.check(),t.delayedDisconnection)return t.delayedDisconnection=!1,t.disconnect()}),this.pollingTime)}},{key:"disconnect",value:function(){return window.clearInterval(this.pollingInterval)}},{key:"disableNotifications",value:function(){return console.log("Wire#disableNotifications - DEPRECATED"),this.disconnect()}},{key:"processNotification",value:function(e){var t,n,r,o,a,s,c;this.log&&console.log(e);var f=i(e,4);if(t=f[0],n=f[1],c=f[2],s=f[3],r=(o=l.default.loco.getModelForRemoteName(t)).getIdentity(),null!=u.IdentityMap.imap[r]&&(null!=u.IdentityMap.imap[r][n]&&(null!=(a=u.IdentityMap.find(r,n)).receivedSignal&&a.receivedSignal(c,s),this._emitSignalToMembers(n,c,s,o,r)),null!=o.receivedSignal&&o.receivedSignal(c,s),null!=u.IdentityMap.imap[r].collection&&0!==u.IdentityMap.imap[r].collection.length))return this._emitSignalToCollection(c,s,r)}},{key:"processSignal",value:function(e){return this.processNotification(e)}},{key:"check",value:function(){var e,t=this;if(0!==Object.keys(u.IdentityMap.imap).length||null!=this.token||null==this.syncTime)return(e=new XMLHttpRequest).open("GET",this._getURL()+"?"+a.default.toURIParams(this._requestParams())),e.onload=function(e){var n,r,i,o,l;if(e.target.status>=200&&e.target.status<400){if(n=JSON.parse(e.target.response),t.disconnectedSinceTime=null,t.syncTime=n[1],0===(l=n[0]).length)return;for(r=0,i=l.length;r<i;r++)o=l[r],t.processNotification(o);if(l.length===t.size)return t.check()}else if(e.target.status>=500)return t._handleDisconnection()},e.onerror=function(){return t._handleDisconnection()},e.send()}},{key:"fetchSyncTime",value:function(){var e,t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(e=new XMLHttpRequest).open("GET",this._getURL()+"/sync-time"),e.onerror=function(){if(null!=n.after)return t[n.after]()},e.onload=function(e){var r;if(e.target.status>=200&&e.target.status<400){if(r=JSON.parse(e.target.response),t.syncTime=r.sync_time,null!=n.after)return t[n.after]()}else if(e.target.status>=500&&null!=n.after)return t[n.after]()},e.send()}},{key:"_emitSignalToMembers",value:function(e,t,n,r,i){var o,l,a,s,c,f=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;for(null==f&&(f=new r({id:e})),c=[],l=0,a=(s=u.IdentityMap.findConnected(i,e)).length;l<a;l++)null!=(o=s[l]).receiverFor(f)?c.push(o[o.receiverFor(f)](t,n)):null!=o.receivedSignal?c.push(o.receivedSignal(t,n)):c.push(void 0);return c}},{key:"_emitSignalToCollection",value:function(e,t,n){var r,i,o,l,a;for(a=[],r=0,i=(l=u.IdentityMap.imap[n].collection).length;r<i;r++)null!=(o=l[r]).receiverFor(n)?a.push(o[o.receiverFor(n)](n+" "+e,t)):null!=o.receivedSignal?a.push(o.receivedSignal(n+" "+e,t)):a.push(void 0);return a}},{key:"_requestParams",value:function(){var e;return e={synced_at:this.syncTime},null!=this.token&&(e.token=this.token),null!=this.uuid&&(e.uuid=this.uuid),e}},{key:"_getURL",value:function(){var e,t,n=window.location.href.split("/"),r=i(n,3);if(t=r[0],r[1],e=r[2],null!=this.protocolWithHost){var o=this.protocolWithHost.split("//"),l=i(o,2);t=l[0],e=l[1]}return null!=this.ssl&&(t=this.ssl?"https:":"http:"),t+"//"+e+"/"+this.location}},{key:"_handleDisconnection",value:function(){var e,t,n;if(null==this.disconnectedSinceTime&&(this.disconnectedSinceTime=new Date),t=(new Date-this.disconnectedSinceTime)/1e3,e=null!=(n=l.default.namespaceController)?n:l.default.controller,t>this.allowedDisconnectionTime&&null!=e.disconnectedForTooLong)return e.disconnectedForTooLong(this.disconnectedSinceTime)}}]),e}(),t.default=r},function(e,t,n){"use strict";n.r(t);var r=n(4),i=n.n(r),o=n(18),l=n.n(o),u=n(19),a=n.n(u),s=n(10),c=n.n(s),f=n(20),d=n.n(f),h={Array:i.a,Collection:l.a,Dom:a.a,Object:c.a,String:d.a};t.default=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();r=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return i(e,null,[{key:"toURIParams",value:function(e){var t,n,r;for(t in n="",e)r=e[t],""!==n&&(n+="&"),n+=t+"="+encodeURIComponent(r);return n}}]),e}(),t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=n(4),a=(r=u)&&r.__esModule?r:{default:r};i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return o(e,[{key:"connectWith",value:function(e){var t,n,r,i,o,u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(null==e)return null;for("Array"!==e.constructor.name&&(e=[e]),o=[],t=0,r=(e=a.default.uniq(e)).length;t<r;t++)"Function"===(i=e[t]).constructor.name?(n=i.getIdentity(),l.IdentityMap.addCollection(n,{to:this}),null!=u.receiver?o.push(this.receivers[n]=u.receiver):o.push(void 0)):(l.IdentityMap.connect(this,{with:i}),null!=u.receiver?o.push(this.receivers[i.toKey()]=u.receiver):o.push(void 0));return o}},{key:"receiverFor",value:function(e){return"String"===e.constructor.name?null!=this.receivers[e]?this.receivers[e]:null:null!=this.receivers[e.toKey()]?this.receivers[e.toKey()]:null}}]),e}(),t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(0),l=c(n(8)),u=c(n(7)),a=c(n(2)),s=c(n(6));function c(e){return e&&e.__esModule?e:{default:e}}r=function(){function e(){var t,n,r,i,o,l=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.wire=null,this.line=null,this.turbolinks=null!=(n=l.turbolinks)&&n,this.startWire=!(null==(r=l.notifications)||!r.enable),this.postInit=l.postInit,this.setLocale(null!=(i=l.locale)?i:"en"),this.setProtocolWithHost(l.protocolWithHost),(t=null!=(o=l.notifications)?o:{}).protocolWithHost=this.getProtocolWithHost(),this.notificationsParams=t}return i(e,[{key:"getWire",value:function(){return this.wire}},{key:"getLine",value:function(){return this.line}},{key:"getLocale",value:function(){return o.Config.locale}},{key:"setLocale",value:function(e){return o.Config.locale=e}},{key:"getProtocolWithHost",value:function(){return o.Config.protocolWithHost}},{key:"setProtocolWithHost",value:function(e){return o.Config.protocolWithHost=e}},{key:"init",value:function(){var e,t=this;return a.default.loco=this,this.initWire(),this.initLine(),this.turbolinks?(e=Number(this.turbolinks)>=5?"turbolinks:load":"page:change",document.addEventListener(e,(function(){if(t.flow(),null!=t.postInit)return t.postInit()}))):this.ready((function(){if(t.flow(),null!=t.postInit)return t.postInit()}))}},{key:"ready",value:function(e){return(document.attachEvent?"complete"===document.readyState:"loading"!==document.readyState)?e():document.addEventListener("DOMContentLoaded",e)}},{key:"initWire",value:function(){if(this.startWire)return this.wire=new l.default(this.notificationsParams),this.wire.fetchSyncTime({after:"connect"})}},{key:"initLine",value:function(){if(null!=o.Deps.cable)return this.line=new u.default,this.line.connect()}},{key:"flow",value:function(){var e,t,n;if(o.IdentityMap.clear(),n=document.getElementsByTagName("body")[0].getAttribute("data-namespace"),t=document.getElementsByTagName("body")[0].getAttribute("data-controller"),e=document.getElementsByTagName("body")[0].getAttribute("data-action"),a.default.action=e,null!=s.default[n]?(a.default.namespaceController=new s.default[n],null!=s.default[n][t]&&(a.default.controller=new s.default[n][t]),null!=a.default.namespaceController.constructor.initialize&&a.default.namespaceController.constructor.initialize(),null!=a.default.namespaceController.initialize&&a.default.namespaceController.initialize(),null!=a.default.controller&&(a.default.namespaceController.setSubController(a.default.controller),a.default.controller.setSuperController(a.default.namespaceController),null!=a.default.controller.constructor.initialize&&a.default.controller.constructor.initialize(),null!=a.default.controller.initialize&&a.default.controller.initialize(),null!=a.default.controller.constructor[e]&&a.default.controller.constructor[e](),null!=a.default.controller[e]&&a.default.controller[e]())):s.default[t]&&(a.default.controller=new s.default[t],null!=a.default.controller.constructor.initialize&&a.default.controller.constructor.initialize(),null!=a.default.controller.initialize&&a.default.controller.initialize(),null!=a.default.controller.constructor[e]&&a.default.controller.constructor[e](),null!=a.default.controller[e]&&a.default.controller[e]()),null!=this.wire)return this.wire.resetSyncTime(),this.wire.fetchSyncTime()}},{key:"emit",value:function(e){return this.line.send(e)}},{key:"getModels",value:function(){var e,t,n,r,i;for(e in n=[],i=/^[A-Z]/,o.Models)if(o.Models[e],i.exec(e)&&"Base"!==e)for(t in n.push(e),r=o.Models[e])r[t],i.exec(t)&&n.push(e+"."+t);return n}},{key:"getModelForRemoteName",value:function(e){var t,n,r,i;for(t=0,n=(i=this.getModels()).length;t<n;t++)if(1===(r=i[t].split(".")).length){if(o.Models[r[0]].getRemoteName()===e)return o.Models[r[0]]}else if(2===r.length&&o.Models[r[0]][r[1]].getRemoteName()===e)return o.Models[r[0]][r[1]]}}]),e}(),t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=a(n(11)),l=n(0),u=a(n(4));function a(e){return e&&e.__esModule?e:{default:e}}r=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.views={},this.receivers={},this.subController=null,this.superController=null,this.params=this.__fetchParams()}return i(e,[{key:"setView",value:function(e,t){return this.views[e]=t}},{key:"getView",value:function(e){return this.views[e]}},{key:"getViews",value:function(){return this.views}},{key:"setSubController",value:function(e){return this.subController=e}},{key:"getSubController",value:function(){return this.subController}},{key:"setSuperController",value:function(e){return this.superController=e}},{key:"getSuperController",value:function(){return this.superController}},{key:"setResource",value:function(e){return this.setScope(e)}},{key:"setScope",value:function(e){return l.Config.scope=e}},{key:"__fetchParams",value:function(){var e,t,n,r,i,o,l,a,s,c,f;if(l={},null!=(n=null!=(o=/https?:\/\/.+\/\w+\/(\d+)/.exec(window.location.href))?o[1]:null)&&(l.id=parseInt(n)),1===(c=window.location.href.split("?")).length)return l;for(s=c[c.length-1],t=0,i=(a=u.default.map(s.split("&"),(function(e){return e.split("=")}))).length;t<i;t++)e=a[t],r=decodeURIComponent(e[0]),null!=(f=decodeURIComponent(e[1]))&&(f=f.replace(/\+/g," ")),l[r]=f;return l}}]),e}(),Object.assign(r.prototype,o.default),t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();r=function(){function e(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return i(e,[{key:"simpleFormat",value:function(e){return(e=(e=e.replace(/\r\n?/,"\n")).trim()).length>0&&(e="<p>"+(e=(e=e.replace(/\n\n+/g,"</p><p>")).replace(/\n/g,"<br>"))+"</p>"),e}}]),e}(),t.default=r},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),r={variants:{},models:{},attributes:{},ui:{form:{sending:"Sending...",success:"Success",errors:{connection:"Connection Error",invalid_data:"Invalid data"}}},date:{formats:{default:"%Y-%m-%d",short:"%b %d",long:"%B %d, %Y"},day_names:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],abbr_day_names:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],month_names:["January","February","March","April","May","June","July","August","September","October","November","December"],abbr_month_names:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]},errors:{messages:{accepted:"must be accepted",blank:"can't be blank",confirmation:"doesn't match %{attribute}",empty:"can't be empty",equal_to:"must be equal to %{count}",even:"must be even",exclusion:"is reserved",greater_than:"must be greater than %{count}",greater_than_or_equal_to:"must be greater than or equal to %{count}",inclusion:"is not included in the list",invalid:"is invalid",less_than:"must be less than %{count}",less_than_or_equal_to:"must be less than or equal to %{count}",not_a_number:"is not a number",not_an_integer:"must be an integer",odd:"must be odd",present:"must be blank",too_long:{one:"is too long (maximum is 1 character)",other:"is too long (maximum is %{count} characters)"},too_short:{one:"is too short (minimum is 1 character)",other:"is too short (minimum is %{count} characters)"},wrong_length:{one:"is the wrong length (should be 1 character)",other:"is the wrong length (should be %{count} characters)"},other_than:"must be other than %{count}"}}},t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=u(n(3)),l=u(n(2));function u(e){return e&&e.__esModule?e:{default:e}}r=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.date=t}return i(e,[{key:"toString",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default";switch(e=o.default[l.default.loco.getLocale()].date.formats,t){case"default":return this.strftime(e.default);case"short":return this.strftime(e.short);case"long":return this.strftime(e.long);default:return console.log("Services.Date#toString: unknown format.")}}},{key:"strftime",value:function(e){var t,n=this;return t=o.default[l.default.loco.getLocale()],(e=(e=(e=(e=(e=(e=(e=(e=e.replace("%Y",(function(e){return n.date.getFullYear()}))).replace("%y",(function(e){return n.date.getFullYear().toString().slice(-2)}))).replace("%m",(function(e){var t;return(t=n.date.getMonth()+1)>=10?t:"0"+t}))).replace("%b",(function(e){return t.date.abbr_month_names[n.date.getMonth()]}))).replace("%B",(function(e){return t.date.month_names[n.date.getMonth()]}))).replace("%d",(function(e){return n.date.getDate()>=10?n.date.getDate():"0"+n.date.getDate()}))).replace("%H",(function(e){return n.date.getHours()>=10?n.date.getHours():"0"+n.date.getHours()}))).replace("%M",(function(e){return n.date.getMinutes()>=10?n.date.getMinutes():"0"+n.date.getMinutes()}))).replace("%S",(function(e){return n.date.getSeconds()>=10?n.date.getSeconds():"0"+n.date.getSeconds()}))}}]),e}(),t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=a(n(9)),l=a(n(3)),u=a(n(2));function a(e){return e&&e.__esModule?e:{default:e}}r=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.formId=t.id,this.obj=t.for,this.initObj=!(null==t.initObj||!t.initObj),this.delegator=t.delegator,this.callbackSuccess=t.callbackSuccess,this.callbackFailure=t.callbackFailure,this.callbackActive=t.callbackActive,this.form=this._findForm(),this.submit=null,this.submitVal=null,null!=this.form&&(this.submit=this.form.querySelector('[type="submit"]')),null!=this.submit&&(this.submitVal=this.submit.value),this.locale=u.default.loco.getLocale()}return i(e,[{key:"getObj",value:function(){return this.obj}},{key:"render",value:function(){return this.initObj?(this._assignAttribs(),this._handle()):null!=this.form?(this.fill(),this._handle()):void 0}},{key:"fill",value:function(){var e,t,n,r,i,l,u,a,s=this,c=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(null==this.obj)return null;if(null==this.obj.constructor.attributes)return null;for(n in e={},null!=c?e[c]=null:e=this.obj.constructor.attributes,u=[],e)e[n],l=this.obj.getAttrRemoteName(n),null!==(r=this.form.querySelector("[data-attr="+l+"]"))&&0!==(t=r.querySelectorAll("input,textarea,select")).length&&(1!==t.length?1!==(a=o.default.Array.uniq(o.default.Array.map(t,(function(e){return e.getAttribute("type")})))).length||"radio"!==a[0]||null==(i=o.default.Collection.find(t,(function(e){return e.value===String(s.obj[n])})))?"hidden"!==t[0].getAttribute("type")&&"checkbox"!==t[t.length-1].getAttribute("type")||u.push(t[t.length-1].checked=Boolean(this.obj[n])):i.checked=!0:t[0].value=this.obj[n]);return u}},{key:"_findForm",value:function(){var e;return null!=this.formId?document.getElementById(""+this.formId):null!=this.obj?(e=this.obj.getIdentity().toLowerCase(),null!=this.obj.id?document.getElementById("edit_"+e+"_"+this.obj.id):document.getElementById("new_"+e)):void 0}},{key:"_handle",value:function(){var e=this;return this.form.addEventListener("submit",(function(t){var n;if(t.preventDefault(),e._canBeSubmitted()){if(null!=e.obj)return e._assignAttribs(),e._hideErrors(),e.obj.isInvalid()?(e._renderErrors(),void(null!=e.callbackFailure&&e.delegator[e.callbackFailure]())):(e._submittingForm(!1),n=null==e.obj.id,e.obj.save().then((function(t){return e._alwaysAfterRequest(),t.success?e._handleSuccess(t,n):(null!=e.callbackFailure&&e.delegator[e.callbackFailure](),e._renderErrors())})).catch((function(t){return e._connectionError()})));e._submitForm()}}))}},{key:"_canBeSubmitted",value:function(){return null==this.submit||!o.default.Dom.hasClass(this.submit,"active")&&(!o.default.Dom.hasClass(this.submit,"success")&&!o.default.Dom.hasClass(this.submit,"failure"))}},{key:"_submitForm",value:function(){var e,t,n,r,i=this;return this._submittingForm(),r=this.form.getAttribute("action")+".json",e=new FormData(this.form),(n=new XMLHttpRequest).open("POST",r),n.setRequestHeader("X-CSRF-Token",null!=(t=document.querySelector("meta[name='csrf-token']"))?t.content:void 0),n.onload=function(t){return i._alwaysAfterRequest(),null!=i.submit&&i.submit.blur(),t.target.status>=200&&t.target.status<400?(e=JSON.parse(t.target.response)).success?i._handleSuccess(e,"POST"===i.form.getAttribute("method")):i._renderErrors(e.errors):t.target.status>=500?i._connectionError():void 0},n.onerror=function(){return i._alwaysAfterRequest(),null!=i.submit&&i.submit.blur(),i._connectionError()},n.send(e)}},{key:"_handleSuccess",value:function(e){var t,n,r,i=this,a=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(r=null!=(t=null!=(n=e.flash)?n.success:void 0)?t:l.default[this.locale].ui.form.success,null!=this.submit&&(o.default.Dom.addClass(this.submit,"success"),this.submit.value=r),null!=e.access_token&&u.default.loco.getWire().setToken(e.access_token),null==this.callbackSuccess)return setTimeout((function(){var e,t,n,r,l,u;if(null!=i.submit&&(i.submit.disabled=!1,o.default.Dom.removeClass(i.submit,"success"),i.submit.value=i.submitVal),u=":not([data-loco-not-clear=true])",a){for(l=[],e=0,t=(r=i.form.querySelectorAll("input:not([type='submit'])"+u+", textarea"+u)).length;e<t;e++)n=r[e],l.push(n.value="");return l}}),5e3);null!=e.data?this.delegator[this.callbackSuccess](e.data):this.delegator[this.callbackSuccess]()}},{key:"_renderErrors",value:function(){var e,t,n,r,i,u,a,s,c,f=this,d=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(!(null!=this.obj&&null==this.obj.errors||null==this.obj&&null==d)){for(e in t=null!=d?d:this.obj.errors)if(n=t[e],null==(c=null!=this.obj?this.obj.getAttrRemoteName(e):e)||"base"===e)"base"===e&&n.length>0&&(1===(a=document.querySelectorAll(".errors[data-for='base']")).length?a[0].textContent=n[0]:null!=this.submit&&(this.submit.value=n[0]));else{if(null===(s=this.form.querySelector("[data-attr="+c+"]")))continue;if(0===(a=s.querySelectorAll(".errors[data-for="+c+"]")).length)continue;for(r=0,i=a.length;r<i;r++)(u=a[r]).textContent=n[0]}return null!=this.submit&&(this.submit.value!==this.submitVal&&this.submit.value!==l.default[this.locale].ui.form.sending||(this.submit.value=l.default[this.locale].ui.form.errors.invalid_data),o.default.Dom.addClass(this.submit,"failure")),this._showErrors(),setTimeout((function(){var e,t,n,r;for(null!=f.submit&&(f.submit.disabled=!1,o.default.Dom.removeClass(f.submit,"failure"),f.submit.value=f.submitVal),r=[],e=0,t=(n=f.form.querySelectorAll("input.invalid, textarea.invalid, select.invalid")).length;e<t;e++)u=n[e],r.push(o.default.Dom.removeClass(u,"invalid"));return r}),1e3)}}},{key:"_assignAttribs",value:function(){var e,t,n,r,i,l,u,a;if(null==this.obj.constructor.attributes)return null;for(t in u=[],i=this.obj.constructor.attributes)i[t],l=this.obj.getAttrRemoteName(t),null!==(n=this.form.querySelector("[data-attr="+l+"]"))&&0!==(e=n.querySelectorAll("input,textarea,select")).length&&(1!==e.length?1!==(a=o.default.Array.uniq(o.default.Array.map(e,(function(e){return e.getAttribute("type")})))).length||"radio"!==a[0]||null==(r=o.default.Collection.find(e,(function(e){return!0===e.checked})))?"hidden"!==e[0].getAttribute("type")&&"checkbox"!==e[e.length-1].getAttribute("type")||(!0===e[e.length-1].checked?u.push(this.obj.assignAttr(t,e[e.length-1].value)):u.push(this.obj.assignAttr(t,e[0].value))):this.obj.assignAttr(t,r.value):this.obj.assignAttr(t,e[0].value));return u}},{key:"_hideErrors",value:function(){var e,t,n,r,i;for(i=[],t=0,n=(r=this.form.querySelectorAll(".errors")).length;t<n;t++)(e=r[t]).textContent.trim().length>0?(e.textContent="",i.push(e.style.display="none")):i.push(void 0);return i}},{key:"_showErrors",value:function(){var e,t,n,r,i;for(i=[],t=0,n=(r=this.form.querySelectorAll(".errors")).length;t<n;t++)(e=r[t]).textContent.trim().length>0?i.push(e.style.display="block"):i.push(void 0);return i}},{key:"_submittingForm",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(null!=this.submit&&(o.default.Dom.removeClass(this.submit,"success"),o.default.Dom.removeClass(this.submit,"failure"),o.default.Dom.addClass(this.submit,"active"),this.submit.value=l.default[this.locale].ui.form.sending),null!=this.callbackActive&&this.delegator[this.callbackActive](),e)return this._hideErrors()}},{key:"_connectionError",value:function(){var e=this;if(null!=this.submit)return o.default.Dom.removeClass(this.submit,"active"),o.default.Dom.addClass(this.submit,"failure"),this.submit.value=l.default[this.locale].ui.form.errors.connection,setTimeout((function(){return e.submit.disabled=!1,o.default.Dom.removeClass(e.submit,"failure"),e.submit.value=e.submitVal}),3e3)}},{key:"_alwaysAfterRequest",value:function(){if(null!=this.submit)return o.default.Dom.removeClass(this.submit,"active")}}]),e}(),t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();r=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return i(e,null,[{key:"find",value:function(e,t){var n,r,i;for(n=0,r=e.length;n<r;n++)if(!0===t(i=e[n]))return i}}]),e}(),t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();r=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return i(e,null,[{key:"hasClass",value:function(e,t){return e.classList?e.classList.contains(t):new RegExp("(^| )"+t+"( |$)","gi").test(e.className)}},{key:"addClass",value:function(e,t){return e.classList?e.classList.add(t):e.className+=" "+t}},{key:"removeClass",value:function(e,t){return e.classList?e.classList.remove(t):e.className=e.className.replace(new RegExp("(^|\\b)"+t.split(" ").join("|")+"(\\b|$)","gi")," ")}}]),e}(),t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();r=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return i(e,null,[{key:"last",value:function(e){return e[e.length-1]}}]),e}(),t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(11),u=(r=l)&&r.__esModule?r:{default:r};i=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.views={},this.intervals={},this.receivers={},this.controller=null,this.delegator=null,null!=t.controller&&this.setController(t.controller),null!=t.delegator&&this.setDelegator(t.delegator)}return o(e,[{key:"setController",value:function(e){return this.controller=e}},{key:"getController",value:function(){return this.controller}},{key:"setView",value:function(e,t){return this.views[e]=t}},{key:"getView",value:function(e){return this.views[e]}},{key:"getViews",value:function(){return this.views}},{key:"setDelegator",value:function(e){return this.delegator=e}},{key:"getDelegator",value:function(e){return this.delegator}}]),e}(),Object.assign(i.prototype,u.default),t.default=i},function(e,t,n){"use strict";n.r(t);var r=n(5),i=n(6),o=n(2),l=n(14),u={Text:n.n(l).a},a=n(3),s=n(7),c=n.n(s),f=n(12),d=n.n(f),h=n(16),v={Date:n.n(h).a},m=n(17),b={Form:n.n(m).a},y=n(9),g=n(21),p={Base:n.n(g).a},k=n(8),_=n.n(k),w=n(0);n.d(t,"Channels",(function(){return r.default})),n.d(t,"Controllers",(function(){return i.default})),n.d(t,"Deps",(function(){return w.Deps})),n.d(t,"Env",(function(){return o.default})),n.d(t,"Helpers",(function(){return u})),n.d(t,"I18n",(function(){return a.default})),n.d(t,"Line",(function(){return c.a})),n.d(t,"Loco",(function(){return d.a})),n.d(t,"Models",(function(){return w.Models})),n.d(t,"Services",(function(){return v})),n.d(t,"UI",(function(){return b})),n.d(t,"Utils",(function(){return y.default})),n.d(t,"Validators",(function(){return w.Validators})),n.d(t,"Views",(function(){return p})),n.d(t,"Wire",(function(){return _.a}))}])}));